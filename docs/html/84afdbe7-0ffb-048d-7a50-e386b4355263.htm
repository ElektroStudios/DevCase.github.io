<!DOCTYPE html >
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" href="../icons/favicon.ico" />
    <link rel="stylesheet" href="../css/bulma.css" />
    <link rel="stylesheet" href="../css/font-awesome.min.css" />
    <link rel="stylesheet" href="../css/presentationStyle.css" />
    <link rel="stylesheet" href="../css/vs.min.css" />
    <script src="../scripts/jquery-3.5.1.min.js"></script>
    <script src="../scripts/clipboard.min.js"></script>
    <script src="../scripts/highlight.min.js"></script>
    <script src="../scripts/presentationStyle.js"></script>
    <title>ShlwApi.AssocQueryString Method</title>
    <meta name="Title" content="AssocQueryString" />
    <meta name="Help.Id" content="M:DevCase.Win32.NativeMethods.ShlwApi.AssocQueryString(DevCase.Win32.Enums.AssocF,DevCase.Win32.Enums.AssocStr,System.String,System.String,System.Text.StringBuilder,System.UInt32@)" />
    <meta name="Help.ContentType" content="Reference" />
    <meta name="container" content="DevCase.Win32.NativeMethods" />
    <meta name="guid" content="84afdbe7-0ffb-048d-7a50-e386b4355263" />
    <meta name="Description" content="Searches for and retrieves a file or protocol association-related string from the registry." />
    <meta name="tocFile" content="../toc/IDATFFA.xml" />
  </head>
  <body>
    <div class="fixedLayout">
      <div id="Header" class="fixedHeader">
        <div class="pageHeader level mb-0 py-2 px-4">
          <div id="TitleContainer" class="level-left">
            <div id="DocumentationTitle" class="level-item">DevCase 6.0 API Reference for NET Framework</div>
          </div>
          <div id="LangFilterSearchContainer" class="level-right">
            <div class="level-item">
              <div class="dropdown is-hoverable">
                <div class="dropdown-trigger">
                  <button class="button" aria-haspopup="true" aria-controls="dropdown-menu">
                    <span id="CurrentLanguage"></span>
                    <span class="icon is-small">
                      <i class="fa fa-angle-down" aria-hidden="true"></i>
                    </span>
                  </button>
                </div>
                <div class="dropdown-menu" role="menu">
                  <div id="LanguageSelections" class="dropdown-content">
                    <a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="vb">VB</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="cpp">C++</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="fs">F#</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="xaml">XAML</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="asp">ASP.NET</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="level-item">
              <form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;">
                <div class="field">
                  <div class="control has-icons-left">
                    <input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" />
                    <span class="icon is-small is-left">
                      <i class="fa fa-search"></i>
                    </span>
                    <button id="SearchButton" type="submit" class="is-hidden"></button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="fixedContent">
        <div id="HeaderPrelimContainer" class="level my-1 px-2">
          <div id="HeaderTextContainer" class="level-left">
            <div class="level-item">
              <span class="has-text-grey-light">
                <div style="text-align: left;">
  <a href="..\index.html">🏠 Home</a>
  <span style="margin: 0 5px;">|</span>
  <a href="javascript:history.back()">⬅️ Back</a>
  <span style="margin: 0 5px;">|</span>
  <a href="javascript:history.forward()">➡️ Forward</a>
</div>
              </span>
            </div>
          </div>
        </div>
        <nav class="breadcrumb my-1 px-2 border-bottom" role="navigation">
          <ul id="TopicBreadcrumbs" />
        </nav>
        <div id="ContentContainer" class="columns pl-5 pr-5 fixedContent">
          <div id="ShowHideTOCColumn" class="column is-hidden-tablet">
            <a id="ShowHideTOC">Show/Hide TOC</a>
          </div>
          <div id="TOCColumn" class="column is-hidden-mobile">
            <nav class="toc">
              <ul id="TableOfContents" class="toc-menu" />
            </nav>
          </div>
          <div id="Resizer" class="is-hidden"></div>
          <div id="TopicContent" class="column content is-7">
            <h1>Shlw<wbr />Api<span id="LST7C073AEB_0" data-languageSpecificText="cpp=::|nu=."></span>Assoc<wbr />Query<wbr />String Method</h1>
            <div class="summary">
 Searches for and retrieves a file or protocol association-related string from the registry.
 </div>
            <h2 class="quickLinkHeader">
              <span class="icon toggleSection" tabindex="0">
                <i class="fa fa-angle-down"></i>
              </span>Definition</h2>
            <div id="IDBSection">
              <strong>Namespace:</strong> <a href="4b8ebc81-6ba2-6fac-af5b-8bb75ecef853.htm">DevCase.Win32.NativeMethods</a><br /><strong>Assembly:</strong> DevCase.net48 (in DevCase.net48.dll) Version: 6.0.0.0 (6.0)<br /><strong>XMLNS for XAML:</strong> Not mapped to an xmlns.<div class="codeSnippet" data-codeSnippetLanguage="cs"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">[<span class="noLink">DllImportAttribute</span>("ShlwApi.dll", CharSet = CharSet.Ansi, BestFitMapping = false, 
	ThrowOnUnmappableChar = true)]
<span class="keyword">public</span> <span class="keyword">static</span> <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a> <span class="identifier">AssocQueryString</span>(
	<a href="2de0c7f5-a074-8601-ebaa-9cb0f26d01f4.htm">AssocF</a> <span class="parameter">flags</span>,
	<a href="725d0937-c192-e6d9-3e75-04c6a5c55427.htm">AssocStr</a> <span class="parameter">str</span>,
	<span class="noLink">string</span> <span class="parameter">assoc</span>,
	<span class="noLink">string</span> <span class="parameter">extra</span>,
	<span class="noLink">StringBuilder</span> <span class="parameter">out</span>,
	<span class="keyword">out</span> <span class="noLink">uint</span> <span class="parameter">refOutSize</span>
)</code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="vb"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vb">&lt;<span class="noLink">DllImportAttribute</span>("ShlwApi.dll", CharSet := CharSet.Ansi, BestFitMapping := false, 
	ThrowOnUnmappableChar := true&gt;]
<span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">AssocQueryString</span> ( 
	<span class="parameter">flags</span> <span class="keyword">As</span> <a href="2de0c7f5-a074-8601-ebaa-9cb0f26d01f4.htm">AssocF</a>,
	<span class="parameter">str</span> <span class="keyword">As</span> <a href="725d0937-c192-e6d9-3e75-04c6a5c55427.htm">AssocStr</a>,
	<span class="parameter">assoc</span> <span class="keyword">As</span> <span class="noLink">String</span>,
	<span class="parameter">extra</span> <span class="keyword">As</span> <span class="noLink">String</span>,
	&lt;<span class="noLink">OutAttribute</span>&gt; <span class="parameter">out</span> <span class="keyword">As</span> <span class="noLink">StringBuilder</span>,
	&lt;<span class="noLink">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">refOutSize</span> <span class="keyword">As</span> <span class="noLink">UInteger</span>
) <span class="keyword">As</span> <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a>

<span class="keyword">Dim</span> <span class="parameter">flags</span> <span class="keyword">As</span> <a href="2de0c7f5-a074-8601-ebaa-9cb0f26d01f4.htm">AssocF</a>
<span class="keyword">Dim</span> <span class="parameter">str</span> <span class="keyword">As</span> <a href="725d0937-c192-e6d9-3e75-04c6a5c55427.htm">AssocStr</a>
<span class="keyword">Dim</span> <span class="parameter">assoc</span> <span class="keyword">As</span> <span class="noLink">String</span>
<span class="keyword">Dim</span> <span class="parameter">extra</span> <span class="keyword">As</span> <span class="noLink">String</span>
<span class="keyword">Dim</span> <span class="parameter">out</span> <span class="keyword">As</span> <span class="noLink">StringBuilder</span>
<span class="keyword">Dim</span> <span class="parameter">refOutSize</span> <span class="keyword">As</span> <span class="noLink">UInteger</span>

<span class="keyword">Dim</span> <span class="parameter">returnValue</span> <span class="keyword">As</span> <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a>

<span class="parameter">returnValue</span> = <a href="edd4d6e4-cc8d-add0-5e5f-8eaeb288cf72.htm">ShlwApi</a>.<span class="identifier">AssocQueryString</span>(<span class="parameter">flags</span>, 
	<span class="parameter">str</span>, <span class="parameter">assoc</span>, <span class="parameter">extra</span>, <span class="parameter">out</span>, <span class="parameter">refOutSize</span>)</code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="cpp"><div class="codeHeader"><span class="codeHeaderTitle">C++</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cpp"><span class="keyword">public</span>:
[<span class="noLink">DllImportAttribute</span>(L"ShlwApi.dll", CharSet = CharSet::Ansi, BestFitMapping = false, 
	ThrowOnUnmappableChar = true)]
<span class="keyword">static</span> <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a> <span class="identifier">AssocQueryString</span>(
	<a href="2de0c7f5-a074-8601-ebaa-9cb0f26d01f4.htm">AssocF</a> <span class="parameter">flags</span>, 
	<a href="725d0937-c192-e6d9-3e75-04c6a5c55427.htm">AssocStr</a> <span class="parameter">str</span>, 
	<span class="noLink">String</span>^ <span class="parameter">assoc</span>, 
	<span class="noLink">String</span>^ <span class="parameter">extra</span>, 
	[<span class="noLink">OutAttribute</span>] <span class="noLink">StringBuilder</span>^ <span class="parameter">out</span>, 
	[<span class="noLink">InAttribute</span>] [<span class="noLink">OutAttribute</span>] <span class="noLink">unsigned int</span>% <span class="parameter">refOutSize</span>
)</code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="fs"><div class="codeHeader"><span class="codeHeaderTitle">F#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-fs">[&lt;<span class="noLink">DllImportAttribute</span>("ShlwApi.dll", CharSet = CharSet.Ansi, BestFitMapping = false, 
	ThrowOnUnmappableChar = true)&gt;]
<span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">AssocQueryString</span> : 
        <span class="parameter">flags</span> : <a href="2de0c7f5-a074-8601-ebaa-9cb0f26d01f4.htm">AssocF</a> * 
        <span class="parameter">str</span> : <a href="725d0937-c192-e6d9-3e75-04c6a5c55427.htm">AssocStr</a> * 
        <span class="parameter">assoc</span> : <span class="noLink">string</span> * 
        <span class="parameter">extra</span> : <span class="noLink">string</span> * 
        <span class="parameter">out</span> : <span class="noLink">StringBuilder</span> <span class="keyword">byref</span> * 
        <span class="parameter">refOutSize</span> : <span class="noLink">uint32</span> <span class="keyword">byref</span> <span class="keyword">-&gt;</span> <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a> </code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="asp"><div class="codeHeader"><span class="codeHeaderTitle">ASP.NET</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-plaintext">No code example is currently available or this language may not be supported.</code></pre></div></div><h4 class="quickLinkHeader">Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">flags</span>  <a href="2de0c7f5-a074-8601-ebaa-9cb0f26d01f4.htm">AssocF</a></dt><dd>
 The flags that can be used to control the search.
 <p />
 It can be any combination of <a href="2de0c7f5-a074-8601-ebaa-9cb0f26d01f4.htm">AssocF</a> values, except that only one <span class="code">AssocF.Ini***</span> value can be included.
 </dd><dt class="has-text-weight-normal"><span class="parameter">str</span>  <a href="725d0937-c192-e6d9-3e75-04c6a5c55427.htm">AssocStr</a></dt><dd>
 An <a href="725d0937-c192-e6d9-3e75-04c6a5c55427.htm">AssocStr</a> value that specifies the type of string that is to be returned.
 </dd><dt class="has-text-weight-normal"><span class="parameter">assoc</span>  <span class="noLink">String</span></dt><dd>
 A pointer to a null-terminated string that is used to determine the root key.
 <p />
 The following four types of strings can be used:
 <p />
 - A file name extension, such as '.txt'.
 <p />
 - A CLSID GUID in the standard '{GUID}' format.
 <p />
 - An application's ProgID, such as 'Word.Document.8.'
 <p />
 - The name of an application's .exe file (The ASSOCF_OPEN_BYEXENAME flag must be set in flags).
 </dd><dt class="has-text-weight-normal"><span class="parameter">extra</span>  <span class="noLink">String</span></dt><dd>
 An optional null-terminated string with additional information about the location of the string.
 <p />
 It is typically set to a Shell verb such as 'open'.
 <p />
 Set this parameter to <span class="keyword"><span id="LST7C073AEB_1" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span> if it is not used.
 </dd><dt class="has-text-weight-normal"><span class="parameter">out</span>  <span class="noLink">StringBuilder</span></dt><dd>
 Pointer to a null-terminated string that, when this function returns successfully, receives the requested string.
 <p />
 Set this parameter to <span class="keyword"><span id="LST7C073AEB_2" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span> to retrieve the required buffer size.
 </dd><dt class="has-text-weight-normal"><span class="parameter">refOutSize</span>  <span class="noLink">UInt32</span><span id="LST7C073AEB_3" data-languageSpecificText="cpp=%"></span></dt><dd>
 A pointer to a value that, when calling the function, is set to the number of characters in the <span class="parameter">out</span> buffer.
 <p />
 When the function returns successfully, the value is set to the number of characters actually placed in the buffer.
 <p />
 If the <a href="2de0c7f5-a074-8601-ebaa-9cb0f26d01f4.htm">NoTruncate</a> flag is set in <span class="parameter">flags</span> and the
 buffer specified in <span class="parameter">out</span> is too small,
 the function returns <span class="code">E_POINTER</span> and the value is set to the required size of the buffer.
 <p />
 If <span class="parameter">out</span> is <span class="keyword"><span id="LST7C073AEB_4" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span>,
 the function returns <span class="code">S_FALSE</span> and <span class="parameter">refOutSize</span> points to the required size, in characters, of the buffer.
 </dd></dl><h4 class="quickLinkHeader">Return Value</h4><a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a><br />
 Returns a standard COM error value, including the following:
 <p /><a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">S_OK</a>: Success.
 <p /><a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">E_POINTER</a>: The <span class="parameter">out</span> buffer is too small to hold the entire string.
 <p /><a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">S_FALSE</a>: <span class="parameter">out</span> is <span class="keyword"><span id="LST7C073AEB_5" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span>,
 <span class="parameter">refOutSize</span> contains the required buffer size.
 </div>
            <h2 class="quickLinkHeader">
              <span class="icon toggleSection" tabindex="0">
                <i class="fa fa-angle-down"></i>
              </span>Remarks</h2>
            <div id="IDBCSection">
              <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/bb773471%28v=vs.85%29.aspx" target="_blank" rel="noopener noreferrer">https://msdn.microsoft.com/en-us/library/windows/desktop/bb773471%28v=vs.85%29.aspx</a>
            </div>
            <h2 class="quickLinkHeader">
              <span class="icon toggleSection" tabindex="0">
                <i class="fa fa-angle-down"></i>
              </span>See Also</h2>
            <div id="seeAlsoSection">
              <h4>Reference</h4>
              <div>
                <a href="edd4d6e4-cc8d-add0-5e5f-8eaeb288cf72.htm">ShlwApi Class</a>
              </div>
              <div>
                <a href="4b8ebc81-6ba2-6fac-af5b-8bb75ecef853.htm">DevCase.Win32.NativeMethods Namespace</a>
              </div>
            </div>
          </div>
          <div id="InThisArticleColumn" class="column is-hidden-mobile">
            <nav class="menu sticky is-hidden">
              <p class="menu-label">
                <strong>In This Article</strong>
              </p>
              <ul id="InThisArticleMenu" class="menu-list">
                <li>
                  <a class="quickLink">Definition</a>
                  <ul class="menu">
                    <li>
                      <a class="quickLink">Parameters</a>
                    </li>
                    <li>
                      <a class="quickLink">Return Value</a>
                    </li>
                  </ul>
                </li>
                <li>
                  <a class="quickLink">Remarks</a>
                </li>
                <li>
                  <a class="quickLink">See Also</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
      <footer id="PageFooter" class="footer border-top py-3 fixedFooter">
        <div class="columns">
          <div class="column">
            <div style="text-align: left;">
  <a href="..\index.html">🏠 Home</a>
  <span style="margin: 0 5px;">|</span>
  <a href="javascript:history.back()">⬅️ Back</a>
  <span style="margin: 0 5px;">|</span>
  <a href="javascript:history.forward()">➡️ Forward</a>
</div>
            <p>ElektroStudios 2024</p>
            <div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:CSG1986%40Hotmail.com?Subject=DevCase%206.0%20API%20Reference%20for%20NET%20Framework">CSG1986@Hotmail.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script> 
				</div>
          <div class="column"> 
				</div>
        </div>
      </footer>
    </div>
    <script>$(function(){
SetDefaultLanguage("vb");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script>
    <script>
		$(".requestExampleLink").each(function ()
		{
			if(this.href.substring(0, 4).toLowerCase() === "http")
				this.href += "?title=";
			else
				this.href += "?subject=DevCase%206.0%20API%20Reference%20for%20NET%20Framework: ";

			this.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
				encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
				"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		});
	</script>
  </body>
</html>