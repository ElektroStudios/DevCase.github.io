<!DOCTYPE html >
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" href="../icons/favicon.ico" />
    <link rel="stylesheet" href="../css/bulma.css" />
    <link rel="stylesheet" href="../css/font-awesome.min.css" />
    <link rel="stylesheet" href="../css/presentationStyle.css" />
    <link rel="stylesheet" href="../css/vs.min.css" />
    <script src="../scripts/jquery-3.5.1.min.js"></script>
    <script src="../scripts/clipboard.min.js"></script>
    <script src="../scripts/highlight.min.js"></script>
    <script src="../scripts/presentationStyle.js"></script>
    <title>IShellIcon.GetIconOf Method</title>
    <meta name="Title" content="GetIconOf" />
    <meta name="Help.Id" content="M:DevCase.Win32.Interfaces.IShellIcon.GetIconOf(DevCase.Win32.Common.PIDL,DevCase.Win32.Enums.GetIconLocationFlags,System.Int32@)" />
    <meta name="Help.ContentType" content="Reference" />
    <meta name="container" content="DevCase.Win32.Interfaces" />
    <meta name="guid" content="eae1c155-a14e-b583-4e1f-c57f1e03037f" />
    <meta name="Description" content="Gets an icon for an object inside a specific folder. If you are unable to retrieve an icon for an object using , use the method to retrieve an object that supports the / function." />
    <meta name="tocFile" content="../toc/IDA0AB0EFA.xml" />
  </head>
  <body>
    <div class="fixedLayout">
      <div id="Header" class="fixedHeader">
        <div class="pageHeader level mb-0 py-2 px-4">
          <div id="TitleContainer" class="level-left">
            <div id="DocumentationTitle" class="level-item">DevCase Class Library 5.0</div>
          </div>
          <div id="LangFilterSearchContainer" class="level-right">
            <div class="level-item">
              <div class="dropdown is-hoverable">
                <div class="dropdown-trigger">
                  <button class="button" aria-haspopup="true" aria-controls="dropdown-menu">
                    <span id="CurrentLanguage"></span>
                    <span class="icon is-small">
                      <i class="fa fa-angle-down" aria-hidden="true"></i>
                    </span>
                  </button>
                </div>
                <div class="dropdown-menu" role="menu">
                  <div id="LanguageSelections" class="dropdown-content">
                    <a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="vb">VB</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="cpp">C++</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="fs">F#</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="xaml">XAML</a>
                    <a class="dropdown-item languageFilterItem" data-languageId="asp">ASP.NET</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="level-item">
              <form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;">
                <div class="field">
                  <div class="control has-icons-left">
                    <input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" />
                    <span class="icon is-small is-left">
                      <i class="fa fa-search"></i>
                    </span>
                    <button id="SearchButton" type="submit" class="is-hidden"></button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="fixedContent">
        <div id="HeaderPrelimContainer" class="level my-1 px-2">
          <div id="HeaderTextContainer" class="level-left">
            <div class="level-item">
              <span class="has-text-grey-light">
                <div style="text-align: left;">
  <a href="..\index.html">🏠 Home</a>
  <span style="margin: 0 5px;">|</span>
  <a href="javascript:history.back()">⬅️ Back</a>
  <span style="margin: 0 5px;">|</span>
  <a href="javascript:history.forward()">➡️ Forward</a>
</div>
              </span>
            </div>
          </div>
        </div>
        <nav class="breadcrumb my-1 px-2 border-bottom" role="navigation">
          <ul id="TopicBreadcrumbs" />
        </nav>
        <div class="columns pl-5 pr-5 fixedContent">
          <div id="ShowHideTOCColumn" class="column is-hidden-tablet">
            <a id="ShowHideTOC">Show/Hide TOC</a>
          </div>
          <div id="TOCColumn" class="column is-hidden-mobile">
            <nav class="toc">
              <ul id="TableOfContents" class="toc-menu" />
            </nav>
          </div>
          <div id="TopicContent" class="column content is-7">
            <h1>IShell<wbr />Icon<span id="LSTA3AD5768_0" data-languageSpecificText="cpp=::|nu=."></span>Get<wbr />Icon<wbr />Of Method</h1>
            <div class="summary">
 Gets an icon for an object inside a specific folder.
 <p />
 If you are unable to retrieve an icon for an object using <span class="selflink">GetIconOf(PIDL, GetIconLocationFlags, Int32<span id="LSTA3AD5768_1" data-languageSpecificText="cpp=%"></span>)</span>, 
 use the <a href="916803dd-ae16-a746-8eb2-fe54dd954a39.htm">GetUIObjectOf(IntPtr, UInt32, <span id="LSTA3AD5768_2" data-languageSpecificText="cpp=array&lt;"></span>IntPtr<span id="LSTA3AD5768_3" data-languageSpecificText="cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]"></span>, Guid<span id="LSTA3AD5768_4" data-languageSpecificText="cpp=%"></span>, IntPtr)</a> method to retrieve an object that supports the 
 <a href="d5c2284a-398c-aa48-975b-5feacc59ef4c.htm">Extract(String, UInt32, IntPtr, IntPtr, UInt32)</a> / <a href="8e702da0-4394-9c08-566b-931a7d983033.htm">Extract(String, UInt32, IntPtr, IntPtr, UInt32)</a> function.
 </div>
            <h2 class="quickLinkHeader">
              <span class="icon toggleSection" tabindex="0">
                <i class="fa fa-angle-down"></i>
              </span>Definition</h2>
            <div id="IDBSection">
              <strong>Namespace:</strong> <a href="58f096c9-7b6d-ef47-ff82-a91553c45344.htm">DevCase.Win32.Interfaces</a><br /><strong>Assembly:</strong> DevCase.Win32 (in DevCase.Win32.dll) Version: 5.0.0.0 (5.0)<br /><strong>XMLNS for XAML:</strong> Not mapped to an xmlns.<div class="codeSnippet" data-codeSnippetLanguage="cs"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">[<a href="https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.preservesigattribute" target="_top" rel="noopener noreferrer">PreserveSigAttribute</a>]
<a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a> <span class="identifier">GetIconOf</span>(
	<a href="a402a4e7-175b-5dd4-da0a-b3a167334455.htm">PIDL</a> <span class="parameter">pidl</span>,
	<a href="ea90bff3-da2d-8df6-81c1-5149523ee70b.htm">GetIconLocationFlags</a> <span class="parameter">flags</span>,
	<span class="keyword">ref</span> <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_top" rel="noopener noreferrer">int</a> <span class="parameter">refIconIndex</span>
)</code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="vb"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vb">&lt;<a href="https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.preservesigattribute" target="_top" rel="noopener noreferrer">PreserveSigAttribute</a>&gt;
<span class="keyword">Function</span> <span class="identifier">GetIconOf</span> ( 
	<span class="parameter">pidl</span> <span class="keyword">As</span> <a href="a402a4e7-175b-5dd4-da0a-b3a167334455.htm">PIDL</a>,
	<span class="parameter">flags</span> <span class="keyword">As</span> <a href="ea90bff3-da2d-8df6-81c1-5149523ee70b.htm">GetIconLocationFlags</a>,
	<span class="keyword">ByRef</span> <span class="parameter">refIconIndex</span> <span class="keyword">As</span> <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_top" rel="noopener noreferrer">Integer</a>
) <span class="keyword">As</span> <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a>

<span class="keyword">Dim</span> <span class="parameter">instance</span> <span class="keyword">As</span> <a href="e2ae42b5-128b-e270-3ead-0ecbd03ce386.htm">IShellIcon</a>
<span class="keyword">Dim</span> <span class="parameter">pidl</span> <span class="keyword">As</span> <a href="a402a4e7-175b-5dd4-da0a-b3a167334455.htm">PIDL</a>
<span class="keyword">Dim</span> <span class="parameter">flags</span> <span class="keyword">As</span> <a href="ea90bff3-da2d-8df6-81c1-5149523ee70b.htm">GetIconLocationFlags</a>
<span class="keyword">Dim</span> <span class="parameter">refIconIndex</span> <span class="keyword">As</span> <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_top" rel="noopener noreferrer">Integer</a>

<span class="keyword">Dim</span> <span class="parameter">returnValue</span> <span class="keyword">As</span> <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a>

<span class="parameter">returnValue</span> = instance.<span class="identifier">GetIconOf</span>(<span class="parameter">pidl</span>, 
	<span class="parameter">flags</span>, <span class="parameter">refIconIndex</span>)</code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="cpp"><div class="codeHeader"><span class="codeHeaderTitle">C++</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cpp">[<a href="https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.preservesigattribute" target="_top" rel="noopener noreferrer">PreserveSigAttribute</a>]
<a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a> <span class="identifier">GetIconOf</span>(
	[<a href="https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.inattribute" target="_top" rel="noopener noreferrer">InAttribute</a>] <a href="a402a4e7-175b-5dd4-da0a-b3a167334455.htm">PIDL</a>^ <span class="parameter">pidl</span>, 
	<a href="ea90bff3-da2d-8df6-81c1-5149523ee70b.htm">GetIconLocationFlags</a> <span class="parameter">flags</span>, 
	<a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_top" rel="noopener noreferrer">int</a>% <span class="parameter">refIconIndex</span>
)</code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="fs"><div class="codeHeader"><span class="codeHeaderTitle">F#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-fs">[&lt;<a href="https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.preservesigattribute" target="_top" rel="noopener noreferrer">PreserveSigAttribute</a>&gt;]
<span class="keyword">abstract</span> <span class="identifier">GetIconOf</span> : 
        <span class="parameter">pidl</span> : <a href="a402a4e7-175b-5dd4-da0a-b3a167334455.htm">PIDL</a> * 
        <span class="parameter">flags</span> : <a href="ea90bff3-da2d-8df6-81c1-5149523ee70b.htm">GetIconLocationFlags</a> * 
        <span class="parameter">refIconIndex</span> : <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_top" rel="noopener noreferrer">int</a> <span class="keyword">byref</span> <span class="keyword">-&gt;</span> <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a> </code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="asp"><div class="codeHeader"><span class="codeHeaderTitle">ASP.NET</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="mailto:CSG1986@Hotmail.com" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-plaintext">No code example is currently available or this language may not be supported.</code></pre></div></div><h4 class="quickLinkHeader">Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">pidl</span>  <a href="a402a4e7-175b-5dd4-da0a-b3a167334455.htm">PIDL</a></dt><dd>
 The address of the ITEMIDLIST structure that specifies the relative location of the folder.
 </dd><dt class="has-text-weight-normal"><span class="parameter">flags</span>  <a href="ea90bff3-da2d-8df6-81c1-5149523ee70b.htm">GetIconLocationFlags</a></dt><dd>
 Flags specifying how the icon is to display. This parameter can be <a href="ea90bff3-da2d-8df6-81c1-5149523ee70b.htm">Null</a>.
 <p />
 The icon should be in the open state if both open-state and closed-state images are available.
 </dd><dt class="has-text-weight-normal"><span class="parameter">refIconIndex</span>  <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_top" rel="noopener noreferrer">Int32</a><span id="LSTA3AD5768_5" data-languageSpecificText="cpp=%"></span></dt><dd>
 Recceives the address of the index of the icon in the system image list. 
 <p />
 Note to Calling Applications: the icon index returned is from the system image list.
 <p />
 The following standard image list indexes can be returned:
 <p />
 0: Document (blank page, not associated)
 <p />
 1: Document (with data on the page)
 <p />
 2: Application (file name extension must be .exe, .com, or .bat)
 <p />
 3: Folder (plain)
 <p />
 4: Folder (open)
 <p /></dd></dl><h4 class="quickLinkHeader">Return Value</h4><a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">HResult</a><br />
 Returns  <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">S_OK</a> if lpIconIndex contains the correct system image list index, 
 or  <a href="1c493191-8f74-2126-88fb-2f9de0d245b6.htm">S_FALSE</a> if an icon can't be obtained for this object.
 <p />
 Note to Calling Applications: The icon index returned is from the system image list.
 </div>
            <h2 class="quickLinkHeader">
              <span class="icon toggleSection" tabindex="0">
                <i class="fa fa-angle-down"></i>
              </span>Remarks</h2>
            <div id="IDFCSection">
              <a href="https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellicon-geticonof" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellicon-geticonof</a>
            </div>
            <h2 class="quickLinkHeader">
              <span class="icon toggleSection" tabindex="0">
                <i class="fa fa-angle-down"></i>
              </span>See Also</h2>
            <div id="seeAlsoSection">
              <h4>Reference</h4>
              <div>
                <a href="e2ae42b5-128b-e270-3ead-0ecbd03ce386.htm">IShellIcon Interface</a>
              </div>
              <div>
                <a href="58f096c9-7b6d-ef47-ff82-a91553c45344.htm">DevCase.Win32.Interfaces Namespace</a>
              </div>
            </div>
          </div>
          <div id="InThisArticleColumn" class="column is-hidden-mobile">
            <nav class="menu sticky is-hidden">
              <p class="menu-label">
                <strong>In This Article</strong>
              </p>
              <ul id="InThisArticleMenu" class="menu-list">
                <li>
                  <a class="quickLink">Definition</a>
                  <ul class="menu">
                    <li>
                      <a class="quickLink">Parameters</a>
                    </li>
                    <li>
                      <a class="quickLink">Return Value</a>
                    </li>
                  </ul>
                </li>
                <li>
                  <a class="quickLink">Remarks</a>
                </li>
                <li>
                  <a class="quickLink">See Also</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
      <footer id="PageFooter" class="footer border-top py-3 fixedFooter">
        <div class="columns">
          <div class="column">
            <div style="text-align: left;">
  <a href="..\index.html">🏠 Home</a>
  <span style="margin: 0 5px;">|</span>
  <a href="javascript:history.back()">⬅️ Back</a>
  <span style="margin: 0 5px;">|</span>
  <a href="javascript:history.forward()">➡️ Forward</a>
</div>
            <p>ElektroStudios 2023</p>
            <div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:CSG1986%40Hotmail.com?Subject=DevCase%20Class%20Library%205.0">CSG1986@Hotmail.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script> 
				</div>
          <div class="column"> 
				</div>
        </div>
      </footer>
    </div>
    <script>$(function(){
SetDefaultLanguage("vb");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script>
    <script>
		$(".requestExampleLink").each(function ()
		{
			if(this.href.substring(0, 4).toLowerCase() === "http")
				this.href += "?title=";
			else
				this.href += "?subject=DevCase%20Class%20Library%205.0: ";

			this.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
				encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
				"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		});
	</script>
  </body>
</html>