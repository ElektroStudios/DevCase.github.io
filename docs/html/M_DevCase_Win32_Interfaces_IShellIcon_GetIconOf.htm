<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="shortcut icon" href="../icons/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="../styles/branding.css" />
    <link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" />
    <script type="text/javascript" src="../scripts/branding.js"> </script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>IShellIcon.GetIconOf Method </title>
    <meta name="Language" content="en-us" />
    <meta name="System.Keywords" content="GetIconOf method" />
    <meta name="System.Keywords" content="IShellIcon.GetIconOf method" />
    <meta name="Microsoft.Help.F1" content="DevCase.Win32.Interfaces.IShellIcon.GetIconOf" />
    <meta name="Microsoft.Help.Id" content="M:DevCase.Win32.Interfaces.IShellIcon.GetIconOf(DevCase.Core.Native.Types.PIDL,DevCase.Win32.Enums.GetIconLocationFlags,System.Int32@)" />
    <meta name="Description" content="Gets an icon for an object inside a specific folder. If you are unable to retrieve an icon for an object using , use the method to retrieve an object that supports the / function." />
    <meta name="Microsoft.Help.ContentType" content="Reference" />
    <meta name="BrandingAware" content="true" />
    
    <meta name="container" content="DevCase.Win32.Interfaces" />
    <meta name="file" content="M_DevCase_Win32_Interfaces_IShellIcon_GetIconOf" />
    <meta name="guid" content="M_DevCase_Win32_Interfaces_IShellIcon_GetIconOf" />
    
    <link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" />
    <script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="../scripts/branding-Website.js"></script>
    <script type="text/javascript" src="../scripts/clipboard.min.js"></script>
  </head>
  <body onload="OnLoad('cs')">
    <input type="hidden" id="userDataCache" class="userDataStyle" />
    <div class="pageHeader" id="PageHeader">DevCase Class Library v4.0<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div>
    <div class="pageBody">
      <div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_DevCase_Class_Library_v4_0.htm" title="DevCase Class Library v4.0" tocid="roottoc">DevCase Class Library v4.0</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/R_Project_DevCase_Class_Library_v4_0.htm" title="Namespaces" tocid="R_Project_DevCase_Class_Library_v4_0">Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/G_DevCase_Win32.htm" title="DevCase.Win32 Namespaces" tocid="G_DevCase_Win32">DevCase.Win32 Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_DevCase_Win32_Interfaces.htm" title="DevCase.Win32.Interfaces" tocid="N_DevCase_Win32_Interfaces">DevCase.Win32.Interfaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_DevCase_Win32_Interfaces_IShellIcon.htm" title="IShellIcon Interface" tocid="T_DevCase_Win32_Interfaces_IShellIcon">IShellIcon Interface</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_DevCase_Win32_Interfaces_IShellIcon.htm" title="IShellIcon Methods" tocid="Methods_T_DevCase_Win32_Interfaces_IShellIcon">IShellIcon Methods</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_DevCase_Win32_Interfaces_IShellIcon_GetIconOf.htm" title="GetIconOf Method " tocid="M_DevCase_Win32_Interfaces_IShellIcon_GetIconOf">GetIconOf Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent">
        <table class="titleTable">
          <tr>
            <td class="titleColumn">
              <h1>IShellIcon<span id="LST403B687_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_0?cpp=::|nu=.");</script>GetIconOf Method </h1>
            </td>
          </tr>
        </table>
        <span class="introStyle"></span> <div class="summary">
 Gets an icon for an object inside a specific folder.
 <p />
 If you are unable to retrieve an icon for an object using <span class="selflink">GetIconOf(PIDL, GetIconLocationFlags, Int32<span id="LST403B687_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_1?cpp=%");</script>)</span>, 
 use the <a href="M_DevCase_Win32_Interfaces_IShellFolder_GetUIObjectOf.htm">GetUIObjectOf(IntPtr, UInt32, <span id="LST403B687_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_2?cpp=array&lt;");</script>IntPtr<span id="LST403B687_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_3?cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]");</script>, Guid<span id="LST403B687_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_4?cpp=%");</script>, IntPtr)</a> method to retrieve an object that supports the 
 <a href="M_DevCase_Win32_Interfaces_IExtractIconA_Extract.htm">Extract(String, UInt32, IntPtr, IntPtr, UInt32)</a> / <a href="M_DevCase_Win32_Interfaces_IExtractIconW_Extract.htm">Extract(String, UInt32, IntPtr, IntPtr, UInt32)</a> function.
 </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_DevCase_Win32_Interfaces.htm">DevCase.Win32.Interfaces</a><br />
    <strong>Assembly:</strong>
   DevCase (in DevCase.dll) Version: 4.0.0.0 (4.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EECA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EECA','cs','1','4');return false;">C#</a></div><div id="ID0EECA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EECA','vb','2','4');return false;">VB</a></div><div id="ID0EECA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EECA','cpp','3','4');return false;">C++</a></div><div id="ID0EECA_tab4" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EECA','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EECA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EECA');return false;" title="Copy">Copy</a></div></div><div id="ID0EECA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">[<span class="identifier">PreserveSigAttribute</span>]
<span class="identifier">HResult</span> <span class="identifier">GetIconOf</span>(
	<span class="identifier">PIDL</span> <span class="parameter">pidl</span>,
	<span class="identifier">GetIconLocationFlags</span> <span class="parameter">flags</span>,
	<span class="keyword">ref</span> <span class="identifier">int</span> <span class="parameter">refIconIndex</span>
)</pre></div><div id="ID0EECA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">&lt;<span class="identifier">PreserveSigAttribute</span>&gt;
<span class="keyword">Function</span> <span class="identifier">GetIconOf</span> ( 
	<span class="parameter">pidl</span> <span class="keyword">As</span> <span class="identifier">PIDL</span>,
	<span class="parameter">flags</span> <span class="keyword">As</span> <span class="identifier">GetIconLocationFlags</span>,
	<span class="keyword">ByRef</span> <span class="parameter">refIconIndex</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
) <span class="keyword">As</span> <span class="identifier">HResult</span>

<span class="keyword">Dim</span> <span class="parameter">instance</span> <span class="keyword">As</span> <span class="identifier">IShellIcon</span>
<span class="keyword">Dim</span> <span class="parameter">pidl</span> <span class="keyword">As</span> <span class="identifier">PIDL</span>
<span class="keyword">Dim</span> <span class="parameter">flags</span> <span class="keyword">As</span> <span class="identifier">GetIconLocationFlags</span>
<span class="keyword">Dim</span> <span class="parameter">refIconIndex</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
<span class="keyword">Dim</span> <span class="parameter">returnValue</span> <span class="keyword">As</span> <span class="identifier">HResult</span>

<span class="parameter">returnValue</span> = instance.<span class="identifier">GetIconOf</span>(<span class="parameter">pidl</span>, 
	<span class="parameter">flags</span>, <span class="parameter">refIconIndex</span>)</pre></div><div id="ID0EECA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">[<span class="identifier">PreserveSigAttribute</span>]
<span class="identifier">HResult</span> <span class="identifier">GetIconOf</span>(
	[<span class="identifier">InAttribute</span>] <span class="identifier">PIDL</span>^ <span class="parameter">pidl</span>, 
	<span class="identifier">GetIconLocationFlags</span> <span class="parameter">flags</span>, 
	<span class="identifier">int</span>% <span class="parameter">refIconIndex</span>
)</pre></div><div id="ID0EECA_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">[&lt;<span class="identifier">PreserveSigAttribute</span>&gt;]
<span class="keyword">abstract</span> <span class="identifier">GetIconOf</span> : 
        <span class="parameter">pidl</span> : <span class="identifier">PIDL</span> * 
        <span class="parameter">flags</span> : <span class="identifier">GetIconLocationFlags</span> * 
        <span class="parameter">refIconIndex</span> : <span class="identifier">int</span> <span class="keyword">byref</span> <span class="keyword">-&gt;</span> <span class="identifier">HResult</span> 
</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EECA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">pidl</span></dt><dd>Type: <a href="T_DevCase_Core_Native_Types_PIDL.htm">DevCase.Core.Native.Types<span id="LST403B687_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PIDL</a><br />
 The address of the ITEMIDLIST structure that specifies the relative location of the folder.
 </dd><dt><span class="parameter">flags</span></dt><dd>Type: <a href="T_DevCase_Win32_Enums_GetIconLocationFlags.htm">DevCase.Win32.Enums<span id="LST403B687_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>GetIconLocationFlags</a><br />
 Flags specifying how the icon is to display. This parameter can be <a href="T_DevCase_Win32_Enums_GetIconLocationFlags.htm">Null</a>.
 <p />
 The icon should be in the open state if both open-state and closed-state images are available.
 </dd><dt><span class="parameter">refIconIndex</span></dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.int32" target="_blank" rel="noopener noreferrer">System<span id="LST403B687_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><span id="LST403B687_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST403B687_8?cpp=%");</script><br />
 Recceives the address of the index of the icon in the system image list. 
 <p />
 Note to Calling Applications: the icon index returned is from the system image list.
 <p />
 The following standard image list indexes can be returned:
 <p />
 0: Document (blank page, not associated)
 <p />
 1: Document (with data on the page)
 <p />
 2: Application (file name extension must be .exe, .com, or .bat)
 <p />
 3: Folder (plain)
 <p />
 4: Folder (open)
 <p /></dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="T_DevCase_Win32_Enums_HResult.htm">HResult</a><br />
 Returns  <a href="T_DevCase_Win32_Enums_HResult.htm">S_OK</a> if lpIconIndex contains the correct system image list index, 
 or  <a href="T_DevCase_Win32_Enums_HResult.htm">S_FALSE</a> if an icon can't be obtained for this object.
 <p />
 Note to Calling Applications: The icon index returned is from the system image list.
 </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection"><a href="https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellicon-geticonof" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellicon-geticonof</a></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_DevCase_Win32_Interfaces_IShellIcon.htm">IShellIcon Interface</a></div><div class="seeAlsoStyle"><a href="N_DevCase_Win32_Interfaces.htm">DevCase.Win32.Interfaces Namespace</a></div></div></div>
    </div>
    <div id="pageFooter" class="pageFooter">
      <p>ElektroStudios 2022</p>
      <div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:CSG1986%40Hotmail.com?Subject=DevCase%20Class%20Library%20v4.0">CSG1986@Hotmail.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div>
  </body>
</html>